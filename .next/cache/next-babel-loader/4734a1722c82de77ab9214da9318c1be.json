{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useState, useEffect } from 'react';\nimport Layout from '../components/Layout';\nimport Link from 'next/link';\nimport Navbar from '../components/dashboard/Navbar';\nimport BannerCard from '../components/dashboard/BannerCard';\nimport fetch from 'isomorphic-unfetch';\nimport { store } from 'react-notifications-component';\nimport { withAuthSync, getToken, auth } from '../utils/auth';\nimport { getUserId } from '../utils/user';\n\nvar Settings = function Settings(_ref) {\n  var user = _ref.user;\n\n  var _useState = useState(user.domain),\n      domain = _useState[0],\n      setDomain = _useState[1];\n\n  var handleDomainChange =\n  /*#__PURE__*/\n  function () {\n    var _ref2 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee(e) {\n      var token, res, data;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              e.preventDefault();\n              token = getToken();\n              _context.next = 4;\n              return fetch(\"http://localhost:3600/users/\".concat(user.id), {\n                method: \"PATCH\",\n                headers: {\n                  'Content-Type': 'application/json',\n                  'Authorization': 'Bearer ' + token\n                },\n                body: _JSON$stringify({\n                  domain: domain\n                })\n              });\n\n            case 4:\n              res = _context.sent;\n              _context.next = 7;\n              return res.json();\n\n            case 7:\n              data = _context.sent;\n\n              if (!data.error) {\n                alert('saved!');\n              } else {\n                alert('Something unexpected happened');\n              }\n\n            case 9:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function handleDomainChange(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(Layout, {\n    title: \"Settings\"\n  }, __jsx(Navbar, null), __jsx(\"section\", {\n    className: \"uk-section uk-section-muted\",\n    style: {\n      height: '95vh'\n    }\n  }, __jsx(\"div\", {\n    className: \"uk-container\"\n  }, __jsx(\"h2\", {\n    className: \"uk-text-bold\"\n  }, \"Settings\"), __jsx(\"form\", {\n    onSubmit: handleDomainChange\n  }, __jsx(\"div\", {\n    className: \"uk-margin\"\n  }, __jsx(\"div\", {\n    className: \"uk-inline uk-width-1-1\"\n  }, __jsx(\"span\", null, \"Domain:\"), __jsx(\"input\", {\n    value: domain,\n    onChange: function onChange(e) {\n      return setDomain(e.target.value);\n    },\n    className: \"uk-input\",\n    type: \"text\",\n    placeholder: \"Email address\",\n    style: {\n      borderRadius: '0.1875rem'\n    }\n  })), __jsx(\"button\", {\n    type: \"submit\",\n    className: \"uk-button uk-button-primary uk-button-small\",\n    style: {\n      borderRadius: '0.1875rem',\n      marginTop: '0.5rem',\n      textTransform: 'none'\n    }\n  }, \"Update\"))))));\n};\n\nSettings.getInitialProps =\n/*#__PURE__*/\nfunction () {\n  var _ref3 = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee2(ctx) {\n    var token, userId, res, user;\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            token = auth(ctx);\n            userId = getUserId(token);\n            _context2.next = 4;\n            return fetch(\"http://localhost:3600/users/\".concat(userId), {\n              method: \"GET\",\n              headers: {\n                'Authorization': 'Bearer ' + token\n              }\n            });\n\n          case 4:\n            res = _context2.sent;\n            _context2.next = 7;\n            return res.json();\n\n          case 7:\n            user = _context2.sent;\n            return _context2.abrupt(\"return\", {\n              user: user\n            });\n\n          case 9:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n\n  return function (_x2) {\n    return _ref3.apply(this, arguments);\n  };\n}();\n\nexport default withAuthSync(Settings);","map":{"version":3,"sources":["/Users/hugojohnsson/Desktop/banner-app/pages/settings.jsx"],"names":["useState","useEffect","Layout","Link","Navbar","BannerCard","fetch","store","withAuthSync","getToken","auth","getUserId","Settings","user","domain","setDomain","handleDomainChange","e","preventDefault","token","id","method","headers","body","res","json","data","error","alert","height","target","value","borderRadius","marginTop","textTransform","getInitialProps","ctx","userId"],"mappings":"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","sourcesContent":["import { useState, useEffect } from 'react';\nimport Layout from '../components/Layout'\nimport Link from 'next/link';\nimport Navbar from '../components/dashboard/Navbar';\nimport BannerCard from '../components/dashboard/BannerCard';\nimport fetch from 'isomorphic-unfetch'\nimport { store } from 'react-notifications-component';\n\nimport { withAuthSync, getToken, auth } from '../utils/auth';\nimport { getUserId } from '../utils/user';\n\nconst Settings = ({ user }) => {\n  const [domain, setDomain] = useState(user.domain);\n\n  const handleDomainChange = async (e) => {\n    e.preventDefault();\n    const token = getToken();\n    const res = await fetch(`http://localhost:3600/users/${user.id}`, {\n      method: \"PATCH\",\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': 'Bearer ' + token\n      },\n      body: JSON.stringify({\n        domain: domain\n      })\n    });\n\n    const data = await res.json();\n    if (!data.error) {\n      alert('saved!')\n    } else {\n      alert('Something unexpected happened')\n    }\n  }\n\n  return (\n    <Layout title=\"Settings\">\n      <Navbar/>\n  \t\t<section className=\"uk-section uk-section-muted\" style={{height:'95vh'}}>\n        <div className=\"uk-container\">\n  \t\t\t\t<h2 className=\"uk-text-bold\">Settings</h2>\n            <form onSubmit={handleDomainChange}>\n              <div className=\"uk-margin\">\n                <div className=\"uk-inline uk-width-1-1\">\n                  <span>Domain:</span>\n                  <input value={domain} onChange={e => setDomain(e.target.value)} className=\"uk-input\" type=\"text\" placeholder=\"Email address\" style={{borderRadius:'0.1875rem'}}/>\n                </div>\n                <button type=\"submit\" className=\"uk-button uk-button-primary uk-button-small\" style={{borderRadius:'0.1875rem', marginTop:'0.5rem', textTransform:'none'}}>Update</button>\n              </div>\n            </form>\n  \t\t\t</div>\n  \t\t</section>\n    </Layout>\n  )\n}\n\nSettings.getInitialProps = async (ctx) => {\n  const token = auth(ctx);\n  const userId = getUserId(token);\n  const res = await fetch(`http://localhost:3600/users/${userId}`, {\n    method: \"GET\",\n    headers: {\n      'Authorization': 'Bearer ' + token\n    }\n  });\n  const user = await res.json();\n\n  return { user }\n}\n\nexport default withAuthSync(Settings);\n"]},"metadata":{},"sourceType":"module"}