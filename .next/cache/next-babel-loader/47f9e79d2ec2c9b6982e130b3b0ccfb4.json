{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\nimport { useState, useEffect } from 'react';\nimport Layout from '../components/Layout';\nimport Link from 'next/link';\nimport Navbar from '../components/dashboard/Navbar';\nimport BannerCard from '../components/dashboard/BannerCard';\nimport fetch from 'isomorphic-unfetch';\nimport { store } from 'react-notifications-component';\nimport { withAuthSync, getToken, auth } from '../utils/auth';\nimport { getUserId, hasPaymentMethod } from '../utils/user';\nimport dynamic from 'next/dynamic';\nconst AddCard = dynamic(() => import('../components/payment/AddCard'), {\n  ssr: false,\n  loadableGenerated: {\n    webpack: () => [require.resolveWeak('../components/payment/AddCard')],\n    modules: ['../components/payment/AddCard']\n  }\n});\n\nconst Billing = props => {\n  const {\n    0: domain,\n    1: setDomain\n  } = useState(props.user.domain);\n  const {\n    0: showAddCard,\n    1: setShowAddCard\n  } = useState(false);\n  const {\n    0: user,\n    1: setUser\n  } = useState(props.user);\n\n  const refetchUserData = async () => {\n    const token = getToken();\n    const userId = getUserId(token);\n    const res = await fetch(`http://localhost:3600/users/${userId}`, {\n      method: \"GET\",\n      headers: {\n        'Authorization': 'Bearer ' + token\n      }\n    });\n    const user = await res.json();\n    setUser(user);\n    return;\n  };\n\n  const renderContent = () => {\n    if (!user.hasPayment) {\n      if (!showAddCard) {\n        return __jsx(React.Fragment, null, __jsx(\"p\", null, \"You don't have a payment method attached to your account.\"), __jsx(\"button\", {\n          onClick: () => setShowAddCard(true),\n          className: \"uk-button uk-button-primary\",\n          style: {\n            borderRadius: '0.1875rem'\n          }\n        }, \"Add a card\"));\n      } else {\n        return __jsx(AddCard, {\n          userId: user.id,\n          userEmail: user.email,\n          cancelAddCard: () => setShowAddCard(false),\n          done: refetchUserData\n        });\n      }\n    } else {\n      return __jsx(\"h1\", null, \"dkasdkls\\xF6a\");\n    }\n  };\n\n  return __jsx(Layout, {\n    title: \"Billing\"\n  }, __jsx(Navbar, null), __jsx(\"section\", {\n    className: \"uk-section uk-section-muted\",\n    style: {\n      height: '95vh'\n    }\n  }, __jsx(\"div\", {\n    className: \"uk-container\"\n  }, __jsx(\"h2\", {\n    className: \"uk-text-bold\"\n  }, \"Billing\"), renderContent())));\n};\n\nBilling.getInitialProps = async ctx => {\n  const token = auth(ctx);\n  const userId = getUserId(token);\n  const res = await fetch(`http://localhost:3600/users/${userId}`, {\n    method: \"GET\",\n    headers: {\n      'Authorization': 'Bearer ' + token\n    }\n  });\n  const user = await res.json();\n  return {\n    user\n  };\n};\n\nexport default withAuthSync(Billing);","map":{"version":3,"sources":["/Users/hugojohnsson/Desktop/banner-app/pages/billing.jsx"],"names":["useState","useEffect","Layout","Link","Navbar","BannerCard","fetch","store","withAuthSync","getToken","auth","getUserId","hasPaymentMethod","dynamic","AddCard","ssr","Billing","props","domain","setDomain","user","showAddCard","setShowAddCard","setUser","refetchUserData","token","userId","res","method","headers","json","renderContent","hasPayment","borderRadius","id","email","height","getInitialProps","ctx"],"mappings":"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","sourcesContent":["import { useState, useEffect } from 'react';\nimport Layout from '../components/Layout'\nimport Link from 'next/link';\nimport Navbar from '../components/dashboard/Navbar';\nimport BannerCard from '../components/dashboard/BannerCard';\nimport fetch from 'isomorphic-unfetch'\nimport { store } from 'react-notifications-component';\n\nimport { withAuthSync, getToken, auth } from '../utils/auth';\nimport { getUserId, hasPaymentMethod } from '../utils/user';\n\nimport dynamic from 'next/dynamic'\n\nconst AddCard = dynamic(\n  () => import('../components/payment/AddCard'),\n  { ssr: false }\n)\n\nconst Billing = (props) => {\n  const [domain, setDomain] = useState(props.user.domain);\n  const [showAddCard, setShowAddCard] = useState(false);\n  const [user, setUser] = useState(props.user);\n\n  const refetchUserData = async () => {\n    const token = getToken();\n    const userId = getUserId(token);\n    const res = await fetch(`http://localhost:3600/users/${userId}`, {\n      method: \"GET\",\n      headers: {\n        'Authorization': 'Bearer ' + token\n      }\n    });\n    const user = await res.json();\n    setUser(user);\n    return\n  }\n\n  const renderContent = () => {\n    if (!user.hasPayment) {\n      if (!showAddCard) {\n        return (\n          <>\n            <p>You don't have a payment method attached to your account.</p>\n            <button onClick={() => setShowAddCard(true)} className=\"uk-button uk-button-primary\" style={{borderRadius:'0.1875rem'}}>Add a card</button>\n          </>\n        )\n      } else {\n        return (\n          <AddCard userId={user.id} userEmail={user.email} cancelAddCard={() => setShowAddCard(false)} done={refetchUserData}/>\n        )\n      }\n    } else {\n      return <h1>dkasdkls√∂a</h1>\n    }\n  }\n\n  return (\n    <Layout title=\"Billing\">\n      <Navbar/>\n  \t\t<section className=\"uk-section uk-section-muted\" style={{height:'95vh'}}>\n        <div className=\"uk-container\">\n  \t\t\t\t<h2 className=\"uk-text-bold\">Billing</h2>\n          {\n            renderContent()\n          }\n  \t\t\t</div>\n  \t\t</section>\n    </Layout>\n  )\n}\n\nBilling.getInitialProps = async (ctx) => {\n  const token = auth(ctx);\n  const userId = getUserId(token);\n  const res = await fetch(`http://localhost:3600/users/${userId}`, {\n    method: \"GET\",\n    headers: {\n      'Authorization': 'Bearer ' + token\n    }\n  });\n  const user = await res.json();\n\n  return { user }\n}\n\nexport default withAuthSync(Billing);\n"]},"metadata":{},"sourceType":"module"}