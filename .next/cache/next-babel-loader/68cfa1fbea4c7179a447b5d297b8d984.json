{"ast":null,"code":"import _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useState, useEffect } from 'react';\nimport Layout from '../components/Layout';\nimport Link from 'next/link';\nimport { useRouter } from 'next/router';\nimport fetch from 'isomorphic-unfetch';\nimport { login, toDashboardIfLoggedIn } from '../utils/auth';\nimport { validateEmail, validatePassword } from '../utils/validate';\nimport { store } from 'react-notifications-component';\n\nconst Login = () => {\n  const {\n    0: email,\n    1: setEmail\n  } = useState('');\n  const {\n    0: password,\n    1: setPassword\n  } = useState('');\n  const {\n    0: showSubscriptionLink,\n    1: setShowSubscriptionLink\n  } = useState(false);\n  const {\n    0: userId,\n    1: setUserId\n  } = useState(null);\n\n  const handleSubmit = async e => {\n    e.preventDefault();\n\n    if (validateEmail(email) && validatePassword(password)) {\n      const res = await fetch('/auth', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: _JSON$stringify({\n          email: email,\n          password: password\n        })\n      });\n      const data = await res.json();\n      console.log(data);\n\n      if (!data.errors) {\n        login(data.accessToken);\n      } else {\n        store.addNotification({\n          message: data.errors[0],\n          type: 'danger',\n          container: 'top-center',\n          animationIn: [\"animated\", \"fadeIn\"],\n          animationOut: [\"animated\", \"fadeOut\"],\n          dismiss: {\n            duration: 9000\n          },\n          width: 400\n        });\n\n        if (data.errors[0] === 'You have not completed the signup process, you do not have a subscription.') {\n          setUserId(data.userId);\n          setShowSubscriptionLink(true);\n        }\n      }\n    } else {}\n  };\n\n  const router = useRouter();\n  useEffect(() => {\n    toDashboardIfLoggedIn();\n    router.prefetch('/dashboard');\n  });\n  return __jsx(Layout, {\n    title: \"Login\"\n  }, __jsx(\"div\", {\n    className: \"uk-section uk-section-muted uk-flex uk-flex-middle uk-animation-fade\",\n    style: {\n      height: \"100vh\"\n    },\n    \"uk-height-viewport\": \"true\"\n  }, __jsx(\"div\", {\n    className: \"uk-width-1-1\"\n  }, __jsx(\"div\", {\n    className: \"uk-container\"\n  }, __jsx(\"div\", {\n    className: \"uk-grid-margin uk-grid uk-grid-stack\",\n    \"uk-grid\": \"true\"\n  }, __jsx(\"div\", {\n    className: \"uk-width-1-1@m\"\n  }, __jsx(\"div\", {\n    className: \"uk-margin uk-width-large uk-margin-auto uk-card uk-card-default uk-card-body\",\n    style: {\n      background: 'inherit',\n      boxShadow: 'none'\n    }\n  }, __jsx(\"h3\", {\n    className: \"uk-card-title uk-text-center\"\n  }, \"Sign in\"), __jsx(\"form\", {\n    onSubmit: handleSubmit\n  }, __jsx(\"div\", {\n    className: \"uk-margin\"\n  }, __jsx(\"div\", {\n    className: \"uk-inline uk-width-1-1\"\n  }, __jsx(\"span\", {\n    className: \"uk-form-icon\",\n    \"uk-icon\": \"icon: mail\"\n  }), __jsx(\"input\", {\n    value: email,\n    onChange: e => setEmail(e.target.value),\n    className: \"uk-input\",\n    type: \"text\",\n    placeholder: \"Email address\",\n    style: {\n      borderRadius: '0.1875rem'\n    }\n  }))), __jsx(\"div\", {\n    className: \"uk-margin\"\n  }, __jsx(\"div\", {\n    className: \"uk-inline uk-width-1-1\"\n  }, __jsx(\"span\", {\n    className: \"uk-form-icon\",\n    \"uk-icon\": \"icon: lock\"\n  }), __jsx(\"input\", {\n    value: password,\n    onChange: e => setPassword(e.target.value),\n    className: \"uk-input\",\n    type: \"password\",\n    placeholder: \"Password\",\n    style: {\n      borderRadius: '0.1875rem'\n    }\n  }))), __jsx(\"div\", {\n    className: \"uk-margin\"\n  }, !showSubscriptionLink ? __jsx(\"button\", {\n    type: \"submit\",\n    className: \"uk-button uk-button-primary uk-button-large uk-width-1-1\",\n    style: {\n      borderRadius: '0.1875rem'\n    }\n  }, \"Login\") : __jsx(Link, {\n    href: {\n      pathname: '/register',\n      query: {\n        userId\n      }\n    }\n  }, __jsx(\"a\", {\n    className: \"uk-button uk-button-primary uk-button-large uk-width-1-1\",\n    style: {\n      borderRadius: '0.1875rem'\n    }\n  }, \"Continue to payment\"))), __jsx(\"div\", {\n    className: \"uk-text-small uk-text-center\"\n  }, \"Not registered? \", __jsx(Link, {\n    href: \"/register\"\n  }, __jsx(\"a\", null, \"Create an account\")))))))))));\n};\n\nexport default Login;","map":{"version":3,"sources":["/Users/hugojohnsson/Desktop/banner-app/pages/login.jsx"],"names":["useState","useEffect","Layout","Link","useRouter","fetch","login","toDashboardIfLoggedIn","validateEmail","validatePassword","store","Login","email","setEmail","password","setPassword","showSubscriptionLink","setShowSubscriptionLink","userId","setUserId","handleSubmit","e","preventDefault","res","method","headers","body","data","json","console","log","errors","accessToken","addNotification","message","type","container","animationIn","animationOut","dismiss","duration","width","router","prefetch","height","background","boxShadow","target","value","borderRadius","pathname","query"],"mappings":"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","sourcesContent":["import { useState, useEffect } from 'react';\nimport Layout from '../components/Layout'\nimport Link from 'next/link';\nimport { useRouter } from 'next/router'\n\nimport fetch from 'isomorphic-unfetch'\nimport { login, toDashboardIfLoggedIn } from '../utils/auth'\nimport { validateEmail, validatePassword } from '../utils/validate'\n\nimport { store } from 'react-notifications-component';\n\nconst Login = () => {\n\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [showSubscriptionLink, setShowSubscriptionLink] = useState(false);\n  const [userId, setUserId] = useState(null);\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n\n    if (validateEmail(email) && validatePassword(password)) {\n      const res = await fetch('/auth', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          email: email,\n          password: password\n        })\n      });\n\n      const data = await res.json();\n      console.log(data)\n      if (!data.errors) {\n        login(data.accessToken);\n      } else {\n        store.addNotification({\n            message: data.errors[0],\n            type: 'danger',\n            container: 'top-center',\n            animationIn: [\"animated\", \"fadeIn\"],\n            animationOut: [\"animated\", \"fadeOut\"],\n            dismiss: {\n              duration: 9000,\n            },\n            width: 400\n        });\n\n        if (data.errors[0] === 'You have not completed the signup process, you do not have a subscription.') {\n          setUserId(data.userId);\n          setShowSubscriptionLink(true);\n        }\n      }\n    } else {\n\n    }\n  }\n\n  const router = useRouter();\n\n  useEffect(() => {\n    toDashboardIfLoggedIn();\n    router.prefetch('/dashboard')\n  })\n\n  return (\n    <Layout title=\"Login\">\n      <div className=\"uk-section uk-section-muted uk-flex uk-flex-middle uk-animation-fade\" style={{height:\"100vh\"}} uk-height-viewport=\"true\">\n      \t<div className=\"uk-width-1-1\">\n      \t\t<div className=\"uk-container\">\n      \t\t\t<div className=\"uk-grid-margin uk-grid uk-grid-stack\" uk-grid=\"true\">\n      \t\t\t\t<div className=\"uk-width-1-1@m\">\n      \t\t\t\t\t<div className=\"uk-margin uk-width-large uk-margin-auto uk-card uk-card-default uk-card-body\" style={{background:'inherit', boxShadow:'none'}}>\n      \t\t\t\t\t\t<h3 className=\"uk-card-title uk-text-center\">Sign in</h3>\n      \t\t\t\t\t\t<form onSubmit={handleSubmit}>\n      \t\t\t\t\t\t\t<div className=\"uk-margin\">\n      \t\t\t\t\t\t\t\t<div className=\"uk-inline uk-width-1-1\">\n      \t\t\t\t\t\t\t\t\t<span className=\"uk-form-icon\" uk-icon=\"icon: mail\"></span>\n      \t\t\t\t\t\t\t\t\t<input value={email} onChange={e => setEmail(e.target.value)} className=\"uk-input\" type=\"text\" placeholder=\"Email address\" style={{borderRadius:'0.1875rem'}}/>\n      \t\t\t\t\t\t\t\t</div>\n      \t\t\t\t\t\t\t</div>\n      \t\t\t\t\t\t\t<div className=\"uk-margin\">\n      \t\t\t\t\t\t\t\t<div className=\"uk-inline uk-width-1-1\">\n      \t\t\t\t\t\t\t\t\t<span className=\"uk-form-icon\" uk-icon=\"icon: lock\"></span>\n      \t\t\t\t\t\t\t\t\t<input value={password} onChange={e => setPassword(e.target.value)}  className=\"uk-input\" type=\"password\" placeholder=\"Password\" style={{borderRadius:'0.1875rem'}}/>\n      \t\t\t\t\t\t\t\t</div>\n      \t\t\t\t\t\t\t</div>\n      \t\t\t\t\t\t\t<div className=\"uk-margin\">\n                      {\n                        !showSubscriptionLink ?\n                        <button type=\"submit\" className=\"uk-button uk-button-primary uk-button-large uk-width-1-1\" style={{borderRadius:'0.1875rem'}}>Login</button>\n                        :\n                        <Link href={{ pathname: '/register', query: { userId } }}><a className=\"uk-button uk-button-primary uk-button-large uk-width-1-1\" style={{borderRadius:'0.1875rem'}}>Continue to payment</a></Link>\n                      }\n      \t\t\t\t\t\t\t</div>\n      \t\t\t\t\t\t\t<div className=\"uk-text-small uk-text-center\">\n      \t\t\t\t\t\t\t\tNot registered? <Link href='/register'><a>Create an account</a></Link>\n      \t\t\t\t\t\t\t</div>\n      \t\t\t\t\t\t</form>\n      \t\t\t\t\t</div>\n      \t\t\t\t</div>\n      \t\t\t</div>\n      \t\t</div>\n      \t</div>\n      </div>\n    </Layout>\n  )\n};\n\nexport default Login;\n"]},"metadata":{},"sourceType":"module"}